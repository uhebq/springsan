<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapperì˜ namespaceì†ì„±ì€ ì—°ê²°í•  mapperì˜ interface í’€ ê²½ë¡œë¡œ ìž‘ì„±  -->
<mapper namespace="com.momo.mapper.BoardMapper">


	<!-- 
	ðŸ˜€ select íƒœê·¸ ìž‘ì„±  
	
		id 			: mapperì˜ ë©”ì„œë“œëª…
		resultType 	: ê¸°ë³¸íƒ€ìž…
					, ê°ì²´íƒ€ìž…(selectì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ íŠ¹ì • í´ëž˜ìŠ¤ì˜ ê°ì²´ë¡œ ì €ìž¥)
					ì¿¼ë¦¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ resultTypeì˜ ì†ì„±ì— ì €ìž¥  
				
		CDATA 		: íŒŒì„œê°€ ë§ˆí¬ì—…ì´ ì•„ë‹Œ ë¬¸ìžë¡œë§Œ í•´ì„ í•  ìˆ˜ ìžˆë„ë¡ ì²˜ë¦¬
						XMLì—ì„œ ë¶€ë“±í˜¸ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©	 
	-->
	<select id="getListXml" resultType="com.momo.vo.BoardVO">
	<![CDATA[
	select * 
	  from (
	  		select t.*, rownum rn
	  		  from (
					select * 
					  from tbl_board 
					 where bno>0
	]]>
					 <include refid="criteria"></include>
					 order by bno desc
					) t
			)
	 where rn between #{startNo} and #{endNo}
	</select>
	
	
	<!-- 
	
	ðŸ˜€ ë™ì  ì¿¼ë¦¬ ìž‘ì„±
		mybatisëŠ” ë‚´ë¶€ì ìœ¼ë¡œ preparedStatementë¥¼ í™œìš©í•©ë‹ˆë‹¤
		? -> #{ì†ì„±}
		
		ì¿¼ë¦¬ìž‘ì„±ì‹œ í•„ìš”í•œ ì •ë³´ëŠ” ë§¤ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ í†µí•´ ë°›ì•„ì˜¬ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
		
	 -->	
	<insert id="insert">
		insert into tbl_board (bno, title, content, writer) 
		values (seq_board.nextval, #{title},#{content},#{writer})
	</insert>

	<!-- 
	ðŸ˜€ selectKey
		ìƒì„±ëœ ì‹œí€€ìŠ¤ê°’ì„ VOê°ì²´ì˜ ì†ì„±ì— ì €ìž¥í›„ ì‚¬ìš© í•©ë‹ˆë‹¤  
	-->
	<insert id="insertSelectKey">
		<selectKey keyProperty="bno" order="BEFORE" resultType="int">
		select seq_board.nextval from dual
		</selectKey>
	
		insert into tbl_board (bno, title, content, writer) 
		values (#{bno}, #{title},#{content},#{writer})
	</insert>	
	
	
	<select id="getOne" resultType="com.momo.vo.BoardVO">
		select * from tbl_board where bno=#{bno}
	</select>
	
	<delete id="delete">
		delete tbl_board where bno=#{bno}
	</delete>
	
	<update id="update">
		update tbl_board
		   set title = #{title}
		   		, content = #{content}
		   		, updatedate  = sysdate
		 where bno = #{bno}  
	</update>
	
	
	<select id="getTotalCnt" resultType="int">
		select count(*) 
		from tbl_board
		where 1=1
		<include refid="criteria"></include>
	</select>
	
	<!--  
	ðŸ˜€ ë°˜ë³µë˜ëŠ” ì¿¼ë¦¬ë¥¼ ë¯¸ë¦¬ ìž‘ì„±í•´ ë†“ê³  ìž¬í™œìš© í•©ë‹ˆë‹¤
		ë°˜ë³µí•  ì¿¼ë¦¬ ì„ ì–¸ : <sql id=""> 
		ì„ ì–¸í•œ ì¿¼ë¦¬ ì‚¬ìš© : <include refId="criteria">
		ë³€ìˆ˜ ì‚¬ìš© ë°©ë²• <property name="">
		
		refId = reference id 
	-->
	<sql id="criteria">
		<choose>
			<when test="searchField == 'title'">
				and title like '%'||#{searchWord}||'%'
			</when>
			<when test="searchField == 'content'">
				and content like '%'||#{searchWord}||'%'
			</when>
			<when test="searchField == 'writer'">
				and writer like '%'||#{searchWord}||'%'
			</when>
		</choose>
	</sql>
	
</mapper>

































